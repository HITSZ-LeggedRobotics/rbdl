<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Rigid Body Dynamics Library: Joint Modeling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Rigid Body Dynamics Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('joint_description.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="d0/d8f/struct_rigid_body_dynamics_1_1_joint.html" title="Describes a joint relative to the predecessor body. ">Joint</a> Modeling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="joint_overview"></a>
Overview</h1>
<p>The Rigid <a class="el" href="da/dd2/struct_rigid_body_dynamics_1_1_body.html" title="Describes all properties of a single body. ">Body</a> Dynamics Library supports a multitude of joints: revolute, planar, fixed, singularity-free spherical joints and joints with multiple degrees of freedom in any combinations.</p>
<p>Fixed joints do not cause any overhead in RBDL as the bodies that are rigidly connected are merged into a single body. For details see <a class="el" href="joint_description.html#joint_models_fixed">Fixed Joints</a>.</p>
<p>Joints with multiple degrees of freedom are emulated by default which means that they are split up into multiple single degree of freedom joints which results in equivalent models. This has the benefit that it simplifies the required algebra and also code branching in RBDL. A special case are joints with three degrees of freedom for which specific joints are available that should be used for performance reasons whenever possible. See <a class="el" href="joint_description.html#joint_three_dof">3-DoF Joints</a> for details.</p>
<p>Joints are defined by their motion subspace. For each degree of freedom a one dimensional motion subspace is specified as a <a class="el" href="d2/da0/namespace_rigid_body_dynamics_1_1_math.html#a3e84ee221851d9f8b98a4f729f0f0ca2">Math::SpatialVector</a>. This vector follows the following convention: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (r_x, r_y, r_z, t_x, t_y, t_z) \]" src="form_65.png"/>
</p>
<p>To specify a planar joint with three degrees of freedom for which the first two are translations in <img class="formulaInl" alt="$x$" src="form_66.png"/> and <img class="formulaInl" alt="$y$" src="form_67.png"/> direction and the last is a rotation around <img class="formulaInl" alt="$z$" src="form_68.png"/>, the following joint definition can be used:</p>
<div class="fragment"><div class="line">Joint planar_joint = Joint (</div><div class="line">     <a class="code" href="d2/da0/namespace_rigid_body_dynamics_1_1_math.html#a3e84ee221851d9f8b98a4f729f0f0ca2">Math::SpatialVector</a> (0., 0., 0., 1.,  0., 0.),</div><div class="line">     <a class="code" href="d2/da0/namespace_rigid_body_dynamics_1_1_math.html#a3e84ee221851d9f8b98a4f729f0f0ca2">Math::SpatialVector</a> (0., 0., 0., 0., 1., 0.),</div><div class="line">     <a class="code" href="d2/da0/namespace_rigid_body_dynamics_1_1_math.html#a3e84ee221851d9f8b98a4f729f0f0ca2">Math::SpatialVector</a> (0., 0., 1., 0., 0., 0.)</div><div class="line">     );</div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Please note that in the Rigid Body Dynamics Library all angles are specified in radians.</dd></dl>
<h1><a class="anchor" id="joint_models_fixed"></a>
Fixed Joints</h1>
<p>Fixed joints do not add an additional degree of freedom to the model. When adding a body that via a fixed joint (i.e. when the type is JointTypeFixed) then the dynamical parameters mass and inertia are merged onto its moving parent. By doing so fixed bodies do not add computational costs when performing dynamics computations.</p>
<p>To ensure a consistent API for the Kinematics such fixed bodies have a different range of ids. Where as the ids start at 1 get incremented for each added body, fixed bodies start at <a class="el" href="d7/d19/struct_rigid_body_dynamics_1_1_model.html#a3c5ff0489406cf61e455a9fb7a22e672" title="Value that is used to discriminate between fixed and movable bodies. ">Model::fixed_body_discriminator</a> which has a default value of std::numeric_limits&lt;unsigned int&gt;::max() /</p><ol type="1">
<li>This means theoretical a maximum of each 2147483646 movable and fixed bodies are possible.</li>
</ol>
<p>To check whether a body is connected by a fixed joint you can use the function <a class="el" href="d7/d19/struct_rigid_body_dynamics_1_1_model.html#a62f90a54aa5d5b198cbcf259a4fc21c8" title="Checks whether the body is rigidly attached to another body. ">Model::IsFixedBodyId()</a>.</p>
<h1><a class="anchor" id="joint_three_dof"></a>
3-DoF Joints</h1>
<p>RBDL has highly efficient implementations for the following three degree of freedom joints: </p><ul>
<li>
<a class="el" href="dd/d16/namespace_rigid_body_dynamics.html#af92f943e3dc4a7d1fb537fa481094fa9aabccc5b6a23fd4725c4035cf28fd06e8">JointTypeTranslationXYZ</a> which first translates along X, then Y, and finally Z. </li>
<li>
<a class="el" href="dd/d16/namespace_rigid_body_dynamics.html#af92f943e3dc4a7d1fb537fa481094fa9ac2f4c70c2caceb1b4f8f67168bedf77c">JointTypeEulerZYX</a> which first rotates around Z, then Y, and then X. </li>
<li>
<a class="el" href="dd/d16/namespace_rigid_body_dynamics.html#af92f943e3dc4a7d1fb537fa481094fa9aa4eb1415202badb8467b015911c7c374">JointTypeEulerXYZ</a> which first rotates around X, then Y, and then Z. </li>
<li>
<a class="el" href="dd/d16/namespace_rigid_body_dynamics.html#af92f943e3dc4a7d1fb537fa481094fa9a489a62de9db7bb0a9e0b8e0b24b892ed">JointTypeEulerYXZ</a> which first rotates around Y, then X, and then Z. </li>
<li>
<a class="el" href="dd/d16/namespace_rigid_body_dynamics.html#af92f943e3dc4a7d1fb537fa481094fa9ab331aa31b1d88c2a56907ce88cf7d958">JointTypeSpherical</a> which is a singularity free joint that uses a Quaternion and the bodies angular velocity (see <a class="el" href="joint_description.html#joint_singularities">Joint Singularities</a> for details). </li>
</ul>
<p>These joints can be created by providing the joint type as an argument to the <a class="el" href="d0/d8f/struct_rigid_body_dynamics_1_1_joint.html" title="Describes a joint relative to the predecessor body. ">Joint</a> constructor, e.g.:</p>
<div class="fragment"><div class="line">Joint joint_rot_zyx = Joint ( <a class="code" href="dd/d16/namespace_rigid_body_dynamics.html#af92f943e3dc4a7d1fb537fa481094fa9ac2f4c70c2caceb1b4f8f67168bedf77c">JointTypeEulerZYX</a> ); </div></div><!-- fragment --><p>Using 3-Dof joints is always favourable over using their emulated counterparts as they are considerably faster and describe the same kinematics and dynamics.</p>
<h1><a class="anchor" id="joint_floatingbase"></a>
Floating-Base Joint (a.k.a. Freeflyer Joint)</h1>
<p>RBDL has a special joint type for floating-base systems that uses the enum JointTypeFloatingBase. The first three DoF are translations along X,Y, and Z. For the rotational part it uses a JointTypeSpherical joint. It is internally modeled by a JointTypeTranslationXYZ and a JointTypeSpherical joint. It is recommended to only use this joint for the very first body added to the model.</p>
<p>Positional variables are translations along X, Y, and Z, and for rotations it uses Quaternions. To set/get the orientation use <a class="el" href="d7/d19/struct_rigid_body_dynamics_1_1_model.html#ad248a1604a08e1954deeee7db467fc91">Model::SetQuaternion</a> () / <a class="el" href="d7/d19/struct_rigid_body_dynamics_1_1_model.html#aee5747b0b1b1f8def16a732d29588868">Model::GetQuaternion()</a> with the body id returned when adding the floating base (i.e. the call to <a class="el" href="d7/d19/struct_rigid_body_dynamics_1_1_model.html#a51525da771a094a0a007b1384a61f196" title="Connects a given body to the model. ">Model::AddBody()</a> or <a class="el" href="d7/d19/struct_rigid_body_dynamics_1_1_model.html#ae0af0f97c74a2de167a2e649cb94b12a" title="Adds a Body to the model such that the previously added Body is the Parent. ">Model::AppendBody()</a>).</p>
<h1><a class="anchor" id="joint_singularities"></a>
Joint Singularities</h1>
<p>Singularities in the models arise when a joint has three rotational degrees of freedom and the rotations are described by Euler- or Cardan-angles. The singularities present in these rotation parametrizations (e.g. for ZYX Euler-angles for rotations where a +/- 90 degrees rotation around the Y-axis) may cause problems in dynamics calculations, such as a rank-deficit joint-space inertia matrix or exploding accelerations in the forward dynamics calculations.</p>
<p>For this case RBDL has the special joint type <a class="el" href="dd/d16/namespace_rigid_body_dynamics.html#af92f943e3dc4a7d1fb537fa481094fa9ab331aa31b1d88c2a56907ce88cf7d958" title="3 DoF joint using Quaternions for joint positional variables and angular velocity for joint velocity ...">RigidBodyDynamics::JointTypeSpherical</a>. When using this joint type the model does not suffer from singularities, however this also results in a change of interpretation for the values <img class="formulaInl" alt="$\mathbf{q}, \mathbf{\dot{q}}, \mathbf{\ddot{q}}$" src="form_69.png"/>, and <img class="formulaInl" alt="$\mathbf{\tau}$" src="form_70.png"/>:</p>
<ul>
<li>
The values in <img class="formulaInl" alt="$\mathbf{q}$" src="form_71.png"/> for the joint parameterizes the orientation of a joint using a Quaternion <img class="formulaInl" alt="$q_i$" src="form_72.png"/>  </li>
<li>
The values in <img class="formulaInl" alt="$\mathbf{\dot{q}}$" src="form_73.png"/> for the joint describe the angular velocity <img class="formulaInl" alt="$\omega$" src="form_74.png"/> of the joint in body coordinates </li>
<li>
The values in <img class="formulaInl" alt="$\mathbf{\ddot{q}}$" src="form_75.png"/> for the joint describe the angular acceleration <img class="formulaInl" alt="$\dot{\omega}$" src="form_76.png"/> of the joint in body coordinates </li>
<li>
The values in <img class="formulaInl" alt="$\mathbf{\tau}$" src="form_70.png"/> for the joint describe the three couples acting on the body in body coordinates that are actuated by the joint. </li>
</ul>
<p>As a result, the dimension of the vector <img class="formulaInl" alt="$\mathbf{q}$" src="form_71.png"/> is higher than of the vector of the velocity variables. Additionally, the values in <img class="formulaInl" alt="$\mathbf{\dot{q}}$" src="form_73.png"/> are <b>not</b> the derivative of <img class="formulaInl" alt="$q$" src="form_20.png"/> and are therefore denoted by <img class="formulaInl" alt="$\mathbf{\bar{q}}$" src="form_77.png"/> (and similarly for the joint accelerations).</p>
<p>RBDL stores the Quaternions in <img class="formulaInl" alt="$\mathbf{q}$" src="form_71.png"/> such that the 4th component of the joint is appended to <img class="formulaInl" alt="$\mathbf{q}$" src="form_71.png"/>. E.g. for a model with the joints: TX, Spherical, TY, Spherical, the values of <img class="formulaInl" alt="$\mathbf{q},\mathbf{\bar{q}},\mathbf{\bar{\bar{q}}},\mathbf{\tau}$" src="form_78.png"/> are:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \mathbf{q} &amp;=&amp; ( q_{tx}, q_{q1,x}, q_{q1,y}, q_{q1,z}, q_{ty}, q_{q2,x}, q_{q2,y}, q_{q2,z}, q_{q1,w}, q_{q2,w})^T \\ \mathbf{\bar{q}} &amp;=&amp; ( \dot{q}_{tx}, \omega_{1,x}, \omega_{1,y}, \omega_{1,z}, \dot{q}_{ty}, \omega_{2,x}, \omega_{2,y}, \omega_{2,z} )^T \\ \mathbf{\bar{\bar{q}}} &amp;=&amp; ( \ddot{q}_{tx}, \dot{\omega}_{1,x}, \dot{\omega}_{1,y}, \dot{\omega}_{1,z}, \ddot{q}_{ty}, \dot{\omega}_{2,x}, \dot{\omega}_{2,y}, \dot{\omega}_{2,z} )^T \\ \mathbf{\tau} &amp;=&amp; ( \tau_{tx}, \tau_{1,x}, \tau_{1,y}, \tau_{1,z}, \tau_{ty}, \tau_{2,x}, \tau_{2,y}, \tau_{2,z} )^T \end{eqnarray*}" src="form_79.png"/>
</p>
<h2><a class="anchor" id="spherical_integration"></a>
Numerical Integration of Quaternions</h2>
<p>An additional consequence of this is, that special treatment is required when numerically integrating the angular velocities. One possibility is to interpret the angular velocity as an axis-angle pair scaled by the timestep and use it create a quaternion that is applied to the previous Quaternion. Another is to compute the quaternion rates from the angular velocity. For details see James Diebel "Representing Attitude: Euler
   Angles, Unit Quaternions, and Rotation Vectors", 2006, <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.110.5134">http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.110.5134</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Mainpage</a></li>
    <li class="footer">Generated on Fri Dec 14 2018 11:39:55 for Rigid Body Dynamics Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
